---
title: "Lemur_SpatialAnalysis"
output: html_document
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}

getwd()
library(remotes)
#remotes::install_github("r-spatial/mapview")
library(tidyverse)
library(sf)
library(leaflet)
library(mapview)
LemurData_Raw <- read.csv("./Data/Raw/872_data.csv")
```
```{r data wranging}
LemurData_Site <- LemurData_Raw %>%
  mutate(Transect_Site2 = Transect_Site) %>%
  separate(col= Transect_Site2, into="Site", sep ="_")

Sf_LemurData_Site <- st_as_sf(LemurData_Site,
                             coords = c('long','lat'),
                             crs = 32739)

Sf_SitesCharacteristics <- Sf_LemurData_Site %>%
  group_by() %>%
  summarise(meanSpeciesDensity = mean(Predicted),
            tpi = mean(tpi),
            roughness=mean(roughness),
            slope= mean(slope),
            aspect = mean(aspect),
            flowdir = mean(flowdir),
            WD = mean(WD))
```

 
```

## Maps

Maping the sites

```{r map}
leaflet(Sf_LemurData_Site) %>%
addTiles()%>%
addMarkers()

mapview(Sf_LemurData_Site, zcol="Site", legend = TRUE)

myMap = mapview(LemurData_Site,
         xcol = "long",
         ycol = "lat", 
         crs = 4269, 
         grid = FALSE,
         zcol = "Site")
myMap

myMap  <- leaflet(data=LemurData_Raw) %>% 
  addTiles() %>% 
  addCircleMarkers(~long,~lat,
                   radius=(2),
                   stroke = FALSE, 
                   fillOpacity = 0.3,
                   popup = ~as.character(`slope`))
myMap
#Show the map
myMap

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
